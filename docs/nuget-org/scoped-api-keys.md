---
title: Chaves de API no escopo
description: Assuma o controle das chaves de API que você usa para efetuar push de pacotes
author: mikejo5000
ms.author: mikejo
ms.date: 06/04/2019
ms.topic: conceptual
ms.openlocfilehash: 12d12d5294a474c4d3e4f5d3cad468bb515d21d5
ms.sourcegitcommit: b6810860b77b2d50aab031040b047c20a333aca3
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/28/2019
ms.locfileid: "67426941"
---
# <a name="scoped-api-keys"></a><span data-ttu-id="a8fff-103">Chaves de API no escopo</span><span class="sxs-lookup"><span data-stu-id="a8fff-103">Scoped API keys</span></span>

<span data-ttu-id="a8fff-104">Para tornar o NuGet um ambiente mais seguro para a distribuição de pacote, você pode assumir o controle das chaves de API adicionando escopos.</span><span class="sxs-lookup"><span data-stu-id="a8fff-104">To make NuGet a more secure environment for package distribution, you can take control of the API keys by adding scopes.</span></span>

<span data-ttu-id="a8fff-105">A capacidade de fornecer o escopo para as chaves de API dará a você um melhor controle sobre suas APIs.</span><span class="sxs-lookup"><span data-stu-id="a8fff-105">The ability to provide scope to your API keys give you better control on your APIs.</span></span> <span data-ttu-id="a8fff-106">Você pode:</span><span class="sxs-lookup"><span data-stu-id="a8fff-106">You can:</span></span>

- <span data-ttu-id="a8fff-107">Criar várias chaves de API no escopo que podem ser usadas para diferentes pacotes com períodos de expiração variados.</span><span class="sxs-lookup"><span data-stu-id="a8fff-107">Create multiple scoped API keys that can be used for different packages with varying expiration timeframes.</span></span>
- <span data-ttu-id="a8fff-108">Obter chaves de API com segurança.</span><span class="sxs-lookup"><span data-stu-id="a8fff-108">Obtain API keys securely.</span></span>
- <span data-ttu-id="a8fff-109">Editar as chaves de API existentes para alterar a aplicabilidade do pacote.</span><span class="sxs-lookup"><span data-stu-id="a8fff-109">Edit existing API keys to change package applicability.</span></span>
- <span data-ttu-id="a8fff-110">Atualizar ou excluir as chaves de API existentes sem dificultar as operações que usam outras chaves.</span><span class="sxs-lookup"><span data-stu-id="a8fff-110">Refresh or delete existing API keys without hampering operations using other keys.</span></span>

## <a name="why-do-we-support-scoped-api-keys"></a><span data-ttu-id="a8fff-111">Por que damos suporte a chaves de API no escopo?</span><span class="sxs-lookup"><span data-stu-id="a8fff-111">Why do we support scoped API keys?</span></span>

<span data-ttu-id="a8fff-112">Damos suporte a escopos para chaves de API a fim de permitir que você tenha permissões mais refinadas.</span><span class="sxs-lookup"><span data-stu-id="a8fff-112">We support scopes for API keys to allow you to have more fine-grained permissions.</span></span> <span data-ttu-id="a8fff-113">Anteriormente, o NuGet oferecia uma única chave de API para uma conta, e essa abordagem apresentava várias desvantagens:</span><span class="sxs-lookup"><span data-stu-id="a8fff-113">Previously, NuGet offered a single API key for an account, and that approach had several drawbacks:</span></span>

- <span data-ttu-id="a8fff-114">**Uma chave de API para controlar todos os pacotes**.</span><span class="sxs-lookup"><span data-stu-id="a8fff-114">**One API key to control all packages**.</span></span> <span data-ttu-id="a8fff-115">Com uma única chave de API que é usada para gerenciar todos os pacotes, fica difícil compartilhar a chave com segurança quando vários desenvolvedores estão envolvidos com diferentes pacotes e quando eles compartilham uma conta de editor.</span><span class="sxs-lookup"><span data-stu-id="a8fff-115">With a single API key that is used to manage all packages, it is difficult to securely share the key when multiple developers are involved with different packages, and when they share a publisher account.</span></span>
- <span data-ttu-id="a8fff-116">**Todas as permissões ou nenhuma**.</span><span class="sxs-lookup"><span data-stu-id="a8fff-116">**All permissions or none**.</span></span> <span data-ttu-id="a8fff-117">Qualquer pessoa com acesso à chave de API tem todas as permissões (publicar, efetuar push e remover da lista) nos pacotes.</span><span class="sxs-lookup"><span data-stu-id="a8fff-117">Anyone with access to the API key has all permissions (publish, push and un-list) on the packages.</span></span> <span data-ttu-id="a8fff-118">Em geral, isso não é desejável em ambiente com várias equipes.</span><span class="sxs-lookup"><span data-stu-id="a8fff-118">This is often not desirable in environment with multiple teams.</span></span>
- <span data-ttu-id="a8fff-119">**Ponto único de falha**.</span><span class="sxs-lookup"><span data-stu-id="a8fff-119">**Single point of failure**.</span></span> <span data-ttu-id="a8fff-120">Uma única chave de API também significa um ponto único de falha.</span><span class="sxs-lookup"><span data-stu-id="a8fff-120">A single API key also means a single point of failure.</span></span> <span data-ttu-id="a8fff-121">Se a chave for comprometida, todos os pacotes associados à conta poderão ficar comprometidos.</span><span class="sxs-lookup"><span data-stu-id="a8fff-121">If the key is compromised, all packages associated with the account could potentially be compromised.</span></span> <span data-ttu-id="a8fff-122">A atualização da chave de API é a única maneira de "conter o vazamento" e evitar uma interrupção no fluxo de trabalho da CI/CD.</span><span class="sxs-lookup"><span data-stu-id="a8fff-122">Refreshing the API key is the only way to plug the leak and avoid an interruption to your CI/CD workflow.</span></span> <span data-ttu-id="a8fff-123">Além disso, pode haver casos em que você deseje revogar o acesso à chave de API para um indivíduo (por exemplo, quando um funcionário sai da organização).</span><span class="sxs-lookup"><span data-stu-id="a8fff-123">In addition, there may be cases when you want to revoke access to the API key for an individual (for example, when an employee leaves the organization).</span></span> <span data-ttu-id="a8fff-124">Atualmente, não existe uma forma perfeita para lidar com isso.</span><span class="sxs-lookup"><span data-stu-id="a8fff-124">There isn’t a clean way to handle this today.</span></span>

<span data-ttu-id="a8fff-125">Com as chaves de API no escopo, tentamos resolver esses problemas e, ao mesmo tempo, garantir que nenhum dos fluxos de trabalho existentes sejam interrompidos.</span><span class="sxs-lookup"><span data-stu-id="a8fff-125">With scoped API keys, we try to address these problems while making sure that none of the existing workflows break.</span></span>

## <a name="acquire-an-api-key"></a><span data-ttu-id="a8fff-126">Adquirir uma chave de API</span><span class="sxs-lookup"><span data-stu-id="a8fff-126">Acquire an API key</span></span>

[!INCLUDE [publish-api-key](../quickstart/includes/publish-api-key.md)]

## <a name="create-scoped-api-keys"></a><span data-ttu-id="a8fff-127">Criar chaves de API no escopo</span><span class="sxs-lookup"><span data-stu-id="a8fff-127">Create scoped API keys</span></span>

<span data-ttu-id="a8fff-128">Você pode criar várias chaves de API com base em seus requisitos.</span><span class="sxs-lookup"><span data-stu-id="a8fff-128">You can create multiple API keys based on your requirements.</span></span> <span data-ttu-id="a8fff-129">Uma chave de API pode se aplicar a um ou mais pacotes, ter escopos variados que concedem privilégios específicos e ter uma data de expiração associada a ela.</span><span class="sxs-lookup"><span data-stu-id="a8fff-129">An API key can apply to one or more packages, have varying scopes that grant specific privileges, and have an expiration date associated with it.</span></span>

<span data-ttu-id="a8fff-130">No exemplo a seguir, você tem uma chave de API chamada `Contoso service CI` que pode ser usada para efetuar push de pacotes para pacotes `Contoso.Service` específicos e é válida por 365 dias.</span><span class="sxs-lookup"><span data-stu-id="a8fff-130">In the following example, you have an API key named `Contoso service CI` that can be used to push packages for specific `Contoso.Service` packages, and is valid for 365 days.</span></span> <span data-ttu-id="a8fff-131">Esse é um cenário típico, em que diferentes equipes da mesma organização trabalham em pacotes diferentes e os membros da equipe recebem a chave que concede privilégios apenas ao pacote no qual estão trabalhando.</span><span class="sxs-lookup"><span data-stu-id="a8fff-131">This is a typical scenario where different teams within the same organization work on different packages, and the members of the team are provided the key that grants them privileges only for the package they are working on.</span></span> <span data-ttu-id="a8fff-132">A expiração serve como um mecanismo para prevenir chaves obsoletas ou esquecidas.</span><span class="sxs-lookup"><span data-stu-id="a8fff-132">The expiration serves as a mechanism to prevent stale or forgotten keys.</span></span>

![Criar chaves de API](media/scoped-api-keys-create-new.png)

## <a name="use-glob-patterns"></a><span data-ttu-id="a8fff-134">Usar padrões glob</span><span class="sxs-lookup"><span data-stu-id="a8fff-134">Use glob patterns</span></span>

<span data-ttu-id="a8fff-135">Se estiver trabalhando em vários pacotes e tiver uma lista grande de pacotes para gerenciar, opte por usar padrões de recurso de curinga para selecionar vários pacotes juntos.</span><span class="sxs-lookup"><span data-stu-id="a8fff-135">If you are working on multiple packages and have a large list of packages to manage, you can choose to use globbing patterns to select multiple packages together.</span></span> <span data-ttu-id="a8fff-136">Por exemplo, caso deseje conceder escopos específicos a uma chave para todos os pacotes cuja ID comece com `Fabrikam.Service`, faça isso especificando `fabrikam.service.*` na caixa de texto **Padrão glob**.</span><span class="sxs-lookup"><span data-stu-id="a8fff-136">For example, if you wish to grant specific scopes to a key for all packages whose ID starts with `Fabrikam.Service`, you could do this by specifying `fabrikam.service.*` in the **Glob pattern** text box.</span></span>

![Criar chaves de API](media/scoped-api-keys-glob-pattern.png)

<span data-ttu-id="a8fff-138">O uso de padrões glob para determinar as permissões da chave de API também se aplica a novos pacotes que correspondem ao padrão glob.</span><span class="sxs-lookup"><span data-stu-id="a8fff-138">Using glob patterns to determine API key permissions also applies to new packages matching the glob pattern.</span></span> <span data-ttu-id="a8fff-139">Por exemplo, se você tentar efetuar push de um novo pacote chamado `Fabrikam.Service.Framework`, poderá fazer isso com a chave criada anteriormente, pois o pacote corresponde ao padrão glob `fabrikam.service.*`.</span><span class="sxs-lookup"><span data-stu-id="a8fff-139">For example, if you try to push a new package named `Fabrikam.Service.Framework`, you can do that with the key created previously, since the package matches the glob pattern `fabrikam.service.*`.</span></span>

## <a name="obtain-api-keys-securely"></a><span data-ttu-id="a8fff-140">Obter chaves de API com segurança</span><span class="sxs-lookup"><span data-stu-id="a8fff-140">Obtain API keys securely</span></span>

<span data-ttu-id="a8fff-141">Por segurança, uma chave recém-criada nunca é mostrada na tela e só fica disponível por meio do botão **Copiar**.</span><span class="sxs-lookup"><span data-stu-id="a8fff-141">For security, a newly created key is never shown on the screen and is only available using the **Copy** button.</span></span> <span data-ttu-id="a8fff-142">Da mesma forma, a chave não é acessível depois que a página é atualizada.</span><span class="sxs-lookup"><span data-stu-id="a8fff-142">Similarly, the key is not accessible after the page is refreshed.</span></span>

![Criar chaves de API](media/scoped-api-keys-obtain-keys.png)

## <a name="edit-existing-api-keys"></a><span data-ttu-id="a8fff-144">Editar as chaves de API existentes</span><span class="sxs-lookup"><span data-stu-id="a8fff-144">Edit existing API keys</span></span>

<span data-ttu-id="a8fff-145">Além disso, o ideal é atualizar as permissões de chave e os escopos sem alterar a própria chave.</span><span class="sxs-lookup"><span data-stu-id="a8fff-145">You may also want to update the key permissions and scopes without changing the key itself.</span></span> <span data-ttu-id="a8fff-146">Caso você tenha uma chave com escopos específicos para um único pacote, poderá optar por aplicar os mesmos escopos a um ou muitos outros pacotes.</span><span class="sxs-lookup"><span data-stu-id="a8fff-146">If you have a key with specific scope(s) for a single package, you can choose to apply the same scope(s) on one or many other packages.</span></span>

![Criar chaves de API](media/scoped-api-keys-edit.png)

## <a name="refresh-or-delete-existing-api-keys"></a><span data-ttu-id="a8fff-148">Atualizar ou excluir as chaves de API existentes</span><span class="sxs-lookup"><span data-stu-id="a8fff-148">Refresh or delete existing API keys</span></span>

<span data-ttu-id="a8fff-149">O proprietário da conta pode optar por atualizar a chave, caso em que a permissão (nos pacotes), o escopo e a expiração permanecem os mesmos, mas uma nova chave é emitida, tornando a chave antiga inutilizável.</span><span class="sxs-lookup"><span data-stu-id="a8fff-149">The account owner can choose to refresh the key, in which case the permission (on packages), scope, and expiry remain the same, but a new key is issued making the old key unusable.</span></span> <span data-ttu-id="a8fff-150">Isso é útil no gerenciamento de chaves obsoletas ou quando há potencial de um vazamento da chave de API.</span><span class="sxs-lookup"><span data-stu-id="a8fff-150">This is helpful in managing stale keys or where there is any potential for an API key leakage.</span></span>

![Criar chaves de API](media/scoped-api-keys-refresh.png)

<span data-ttu-id="a8fff-152">Você também poderá optar por excluir essas chaves se elas não forem mais necessárias.</span><span class="sxs-lookup"><span data-stu-id="a8fff-152">You may also choose to delete these keys if they are not needed anymore.</span></span> <span data-ttu-id="a8fff-153">A exclusão de uma chave remove a chave e a torna inutilizável.</span><span class="sxs-lookup"><span data-stu-id="a8fff-153">Deleting a key removes the key and makes it unusable.</span></span>

## <a name="faqs"></a><span data-ttu-id="a8fff-154">Perguntas frequentes</span><span class="sxs-lookup"><span data-stu-id="a8fff-154">FAQs</span></span>

### <a name="what-happens-to-my-old-legacy-api-key"></a><span data-ttu-id="a8fff-155">O que acontecerá com minha chave de API antiga (herdada)?</span><span class="sxs-lookup"><span data-stu-id="a8fff-155">What happens to my old (legacy) API key?</span></span>

<span data-ttu-id="a8fff-156">Sua chave de API antiga (herdada) continuará funcionando e poderá funcionar pelo tempo que você desejar.</span><span class="sxs-lookup"><span data-stu-id="a8fff-156">Your old API key (legacy) continues to work and can work as long as you want it to work.</span></span> <span data-ttu-id="a8fff-157">No entanto, essas chaves serão desativadas se não forem usadas por mais de 365 dias para efetuar push de um pacote.</span><span class="sxs-lookup"><span data-stu-id="a8fff-157">However, these keys will be retired if they have not been used for more than 365 days to push a package.</span></span> <span data-ttu-id="a8fff-158">Para obter mais detalhes, confira a postagem no blog [Alterações nas chaves de API com data de expiração](https://blog.nuget.org/20160825/Changes-to-Expiring-API-Keys.html).</span><span class="sxs-lookup"><span data-stu-id="a8fff-158">For more details, see the blog post [Changes to expiring API keys](https://blog.nuget.org/20160825/Changes-to-Expiring-API-Keys.html).</span></span> <span data-ttu-id="a8fff-159">Não será mais possível atualizar essa chave.</span><span class="sxs-lookup"><span data-stu-id="a8fff-159">You can no longer refresh this key.</span></span> <span data-ttu-id="a8fff-160">Você precisará excluir a chave herdada e criar outra chave no escopo.</span><span class="sxs-lookup"><span data-stu-id="a8fff-160">You need to delete the legacy key and create a new scoped key instead.</span></span>

> [!NOTE]
> <span data-ttu-id="a8fff-161">Essa chave tem todas as permissões em todos os pacotes e nunca expira.</span><span class="sxs-lookup"><span data-stu-id="a8fff-161">This key has all permissions on all the packages and it never expires.</span></span> <span data-ttu-id="a8fff-162">Considere excluir essa chave e criar outras chaves com permissões no escopo e expiração definida.</span><span class="sxs-lookup"><span data-stu-id="a8fff-162">You should consider deleting this key and creating new keys with scoped permissions and definite expiry.</span></span>

### <a name="how-many-api-keys-can-i-create"></a><span data-ttu-id="a8fff-163">Quantas chaves de API podem ser criadas?</span><span class="sxs-lookup"><span data-stu-id="a8fff-163">How many API keys can I create?</span></span>

<span data-ttu-id="a8fff-164">Não há nenhum limite no número de chaves de API que podem ser criadas.</span><span class="sxs-lookup"><span data-stu-id="a8fff-164">There is no limit on the number of API keys you can create.</span></span> <span data-ttu-id="a8fff-165">No entanto, recomendamos limitar esse número a uma contagem gerenciável, para não acabar tendo muitas chaves obsoletas sem nenhum conhecimento de quem está usando as chaves e do local em que estão sendo usadas.</span><span class="sxs-lookup"><span data-stu-id="a8fff-165">However, we advise you to keep it to a manageable count so that you do not end up having many stale keys with no knowledge of where and who is using them.</span></span>

### <a name="can-i-delete-my-legacy-api-key-or-discontinue-using-now"></a><span data-ttu-id="a8fff-166">Posso excluir minha chave de API herdada ou descontinuar seu uso agora?</span><span class="sxs-lookup"><span data-stu-id="a8fff-166">Can I delete my legacy API key or discontinue using now?</span></span>

<span data-ttu-id="a8fff-167">Sim.</span><span class="sxs-lookup"><span data-stu-id="a8fff-167">Yes.</span></span> <span data-ttu-id="a8fff-168">Você pode – e provavelmente deve – excluir sua chave de API herdada.</span><span class="sxs-lookup"><span data-stu-id="a8fff-168">You can--and you probably should--delete your legacy API key.</span></span>

### <a name="can-i-get-back-my-api-key-that-i-deleted-by-mistake"></a><span data-ttu-id="a8fff-169">Posso recuperar minha chave de API excluída por engano?</span><span class="sxs-lookup"><span data-stu-id="a8fff-169">Can I get back my API key that I deleted by mistake?</span></span>

<span data-ttu-id="a8fff-170">Nº</span><span class="sxs-lookup"><span data-stu-id="a8fff-170">No.</span></span> <span data-ttu-id="a8fff-171">Depois que a chave for excluída, você só poderá criar outras chaves.</span><span class="sxs-lookup"><span data-stu-id="a8fff-171">Once deleted, you can only create new keys.</span></span> <span data-ttu-id="a8fff-172">Não há nenhuma recuperação possível para chaves excluídas acidentalmente.</span><span class="sxs-lookup"><span data-stu-id="a8fff-172">There is no recovery possible for accidentally deleted keys.</span></span>

### <a name="does-the-old-api-key-continue-to-work-upon-api-key-refresh"></a><span data-ttu-id="a8fff-173">A chave de API antiga continua funcionando após a atualização da chave de API?</span><span class="sxs-lookup"><span data-stu-id="a8fff-173">Does the old API key continue to work upon API key refresh?</span></span>

<span data-ttu-id="a8fff-174">Nº</span><span class="sxs-lookup"><span data-stu-id="a8fff-174">No.</span></span> <span data-ttu-id="a8fff-175">Depois que você atualiza uma chave, é gerada uma nova chave que tem o mesmo escopo, a mesma permissão e a mesma expiração da antiga.</span><span class="sxs-lookup"><span data-stu-id="a8fff-175">Once you refresh a key, a new key gets generated that has the same scope, permission, and expiry as the old one.</span></span> <span data-ttu-id="a8fff-176">A chave antiga deixa de existir.</span><span class="sxs-lookup"><span data-stu-id="a8fff-176">The old key ceases to exist.</span></span>

### <a name="can-i-give-more-permissions-to-an-existing-api-key"></a><span data-ttu-id="a8fff-177">Posso conceder mais permissões a uma chave de API existente?</span><span class="sxs-lookup"><span data-stu-id="a8fff-177">Can I give more permissions to an existing API key?</span></span>

<span data-ttu-id="a8fff-178">Não é possível modificar o escopo, mas é possível editar a lista de pacotes a qual ele é aplicável.</span><span class="sxs-lookup"><span data-stu-id="a8fff-178">You cannot modify the scope, but you can edit the package list it is applicable to.</span></span>

### <a name="how-do-i-know-if-any-of-my-keys-expired-or-are-getting-expired"></a><span data-ttu-id="a8fff-179">Como saber se uma de minhas chaves expirou ou se está prestes a expirar?</span><span class="sxs-lookup"><span data-stu-id="a8fff-179">How do I know if any of my keys expired or are getting expired?</span></span>

<span data-ttu-id="a8fff-180">Se qualquer chave expirar, nós o informaremos por meio de uma mensagem de aviso na parte superior da página.</span><span class="sxs-lookup"><span data-stu-id="a8fff-180">If any key expires, we will let you know through a warning message at the top of the page.</span></span> <span data-ttu-id="a8fff-181">Também enviamos um email de aviso ao titular da conta dez dias antes da expiração da chave, de modo que você possa tomar providências antecipadamente.</span><span class="sxs-lookup"><span data-stu-id="a8fff-181">We also send a warning e-mail to the account holder ten days before the expiration of the key so that you can act on it well in advance.</span></span>